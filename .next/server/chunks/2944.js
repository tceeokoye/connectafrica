"use strict";exports.id=2944,exports.ids=[2944],exports.modules={75525:(e,t,r)=>{r.d(t,{Z:()=>Q});var n=r(10326),a=r(17577),i=r(75991),s=r(84386),o=r(91664),l=r(41190),d=r(82015),c=r(29280),u=r(48051),m=r(93095),f=r(82561),p=r(52067),g=r(53405),h=r(2566),x=r(65819),b=e=>{let{present:t,children:r}=e,n=function(e){var t,r;let[n,i]=a.useState(),s=a.useRef(null),o=a.useRef(e),l=a.useRef("none"),[d,c]=(t=e?"mounted":"unmounted",r={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},a.useReducer((e,t)=>r[e][t]??e,t));return a.useEffect(()=>{let e=v(s.current);l.current="mounted"===d?e:"none"},[d]),(0,x.b)(()=>{let t=s.current,r=o.current;if(r!==e){let n=l.current,a=v(t);e?c("MOUNT"):"none"===a||t?.display==="none"?c("UNMOUNT"):r&&n!==a?c("ANIMATION_OUT"):c("UNMOUNT"),o.current=e}},[e,c]),(0,x.b)(()=>{if(n){let e;let t=n.ownerDocument.defaultView??window,r=r=>{let a=v(s.current).includes(r.animationName);if(r.target===n&&a&&(c("ANIMATION_END"),!o.current)){let r=n.style.animationFillMode;n.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===n.style.animationFillMode&&(n.style.animationFillMode=r)})}},a=e=>{e.target===n&&(l.current=v(s.current))};return n.addEventListener("animationstart",a),n.addEventListener("animationcancel",r),n.addEventListener("animationend",r),()=>{t.clearTimeout(e),n.removeEventListener("animationstart",a),n.removeEventListener("animationcancel",r),n.removeEventListener("animationend",r)}}c("ANIMATION_END")},[n,c]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:a.useCallback(e=>{s.current=e?getComputedStyle(e):null,i(e)},[])}}(t),i="function"==typeof r?r({present:n.isPresent}):a.Children.only(r),s=(0,u.e)(n.ref,function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(r=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}(i));return"function"==typeof r||n.isPresent?a.cloneElement(i,{ref:s}):null};function v(e){return e?.animationName||"none"}b.displayName="Presence";var y=r(45226),j="Checkbox",[N,w]=(0,m.b)(j),[k,E]=N(j);function A(e){let{__scopeCheckbox:t,checked:r,children:i,defaultChecked:s,disabled:o,form:l,name:d,onCheckedChange:c,required:u,value:m="on",internal_do_not_use_render:f}=e,[g,h]=(0,p.T)({prop:r,defaultProp:s??!1,onChange:c,caller:j}),[x,b]=a.useState(null),[v,y]=a.useState(null),N=a.useRef(!1),w=!x||!!l||!!x.closest("form"),E={checked:g,disabled:o,setChecked:h,control:x,setControl:b,name:d,form:l,value:m,hasConsumerStoppedPropagationRef:N,required:u,defaultChecked:!D(s)&&s,isFormControl:w,bubbleInput:v,setBubbleInput:y};return(0,n.jsx)(k,{scope:t,...E,children:"function"==typeof f?f(E):i})}var C="CheckboxTrigger",S=a.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...i},s)=>{let{control:o,value:l,disabled:d,checked:c,required:m,setControl:p,setChecked:g,hasConsumerStoppedPropagationRef:h,isFormControl:x,bubbleInput:b}=E(C,e),v=(0,u.e)(s,p),j=a.useRef(c);return a.useEffect(()=>{let e=o?.form;if(e){let t=()=>g(j.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[o,g]),(0,n.jsx)(y.WV.button,{type:"button",role:"checkbox","aria-checked":D(c)?"mixed":c,"aria-required":m,"data-state":U(c),"data-disabled":d?"":void 0,disabled:d,value:l,...i,ref:v,onKeyDown:(0,f.M)(t,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,f.M)(r,e=>{g(e=>!!D(e)||!e),b&&x&&(h.current=e.isPropagationStopped(),h.current||e.stopPropagation())})})});S.displayName=C;var T=a.forwardRef((e,t)=>{let{__scopeCheckbox:r,name:a,checked:i,defaultChecked:s,required:o,disabled:l,value:d,onCheckedChange:c,form:u,...m}=e;return(0,n.jsx)(A,{__scopeCheckbox:r,checked:i,defaultChecked:s,disabled:l,required:o,onCheckedChange:c,name:a,form:u,value:d,internal_do_not_use_render:({isFormControl:e})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S,{...m,ref:t,__scopeCheckbox:r}),e&&(0,n.jsx)(O,{__scopeCheckbox:r})]})})});T.displayName=j;var P="CheckboxIndicator",R=a.forwardRef((e,t)=>{let{__scopeCheckbox:r,forceMount:a,...i}=e,s=E(P,r);return(0,n.jsx)(b,{present:a||D(s.checked)||!0===s.checked,children:(0,n.jsx)(y.WV.span,{"data-state":U(s.checked),"data-disabled":s.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});R.displayName=P;var I="CheckboxBubbleInput",O=a.forwardRef(({__scopeCheckbox:e,...t},r)=>{let{control:i,hasConsumerStoppedPropagationRef:s,checked:o,defaultChecked:l,required:d,disabled:c,name:m,value:f,form:p,bubbleInput:x,setBubbleInput:b}=E(I,e),v=(0,u.e)(r,b),j=(0,g.D)(o),N=(0,h.t)(i);a.useEffect(()=>{if(!x)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!s.current;if(j!==o&&e){let r=new Event("click",{bubbles:t});x.indeterminate=D(o),e.call(x,!D(o)&&o),x.dispatchEvent(r)}},[x,j,o,s]);let w=a.useRef(!D(o)&&o);return(0,n.jsx)(y.WV.input,{type:"checkbox","aria-hidden":!0,defaultChecked:l??w.current,required:d,disabled:c,name:m,value:f,form:p,...t,tabIndex:-1,ref:v,style:{...t.style,...N,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function D(e){return"indeterminate"===e}function U(e){return D(e)?"indeterminate":e?"checked":"unchecked"}O.displayName=I;var M=r(32933),L=r(51223);let B=a.forwardRef(({className:e,...t},r)=>n.jsx(T,{ref:r,className:(0,L.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(R,{className:(0,L.cn)("flex items-center justify-center text-current"),children:n.jsx(M.Z,{className:"h-4 w-4"})})}));B.displayName=T.displayName;var z=r(94019),F=r(85999),_=r(35047),$=r(9543);let W=["Food","Community","Outreach","Health","Education","Donation","Volunteers","Events","Impact"];function Q({isOpen:e,onClose:t,blog:r,onSave:u}){let m=(0,_.useRouter)(),f=(0,$.v9)(e=>e.token.token),[p,g]=(0,a.useState)(""),[h,x]=(0,a.useState)(""),[b,v]=(0,a.useState)(""),[y,j]=(0,a.useState)("Admin"),[N,w]=(0,a.useState)(""),[k,E]=(0,a.useState)("News"),[A,C]=(0,a.useState)(!1),[S,T]=(0,a.useState)([]),[P,R]=(0,a.useState)(null),[I,O]=(0,a.useState)(null),[D,U]=(0,a.useState)(!1),L=()=>{g(""),x(""),v(""),j("Admin"),w(""),E("News"),C(!1),T([]),R(null),O(null)},Q=e=>{T(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},V=async e=>{if(e.preventDefault(),console.log("blog token",f),U(!0),!f){F.A.error("Your session expired. Please login again."),m.push("/admin/auth/login"),U(!1);return}try{if(!f){U(!1),t(),F.A.error("Login expired, redirecting..."),m.push("/admin/auth/login");return}}catch{F.A.error("Authentication failed. Please login again."),m.push("/admin/auth/login"),U(!1);return}if(!p||!h||!b||!k){F.A.error("Please complete all required fields."),U(!1);return}if(!r&&!P){F.A.error("Please upload a blog image."),U(!1);return}try{let e=I;if(P&&(e=await new Promise((e,t)=>{let r=new FileReader;r.readAsDataURL(P),r.onload=()=>e(r.result),r.onerror=t})),A){let e=await fetch("/api/v1/admin/blog/unset-featured",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`}});if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.message||`Failed to unset existing featured blog (${e.status})`)}}let n=r?`/api/v1/admin/blog/edit/${r._id}`:"/api/v1/admin/blog/create",a=await fetch(n,{method:r?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({title:p,excerpt:h,content:b,author:y,readTime:N,category:k,featured:A,tags:S,imageBase64:e})});if(401===a.status){F.A.error("Session expired. Please login again."),m.push("/admin/auth/login"),U(!1);return}let i=await a.json();if(!a.ok)throw Error(i?.message||`Request failed (${a.status})`);F.A.success(r?"Blog updated âœ¨":"Blog published \uD83C\uDF89"),u&&await u(),t(),L()}catch(e){F.A.error(e.message||"Something went wrong.")}finally{U(!1)}};return n.jsx(i.AnimatePresence,{children:e&&n.jsx(s.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 px-4",children:(0,n.jsxs)(s.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-card rounded-2xl shadow-xl w-full max-w-2xl p-6 relative overflow-y-auto max-h-[90vh]",children:[n.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-muted-foreground hover:text-foreground",children:n.jsx(z.Z,{size:20})}),n.jsx("h2",{className:"text-2xl font-bold mb-5",children:r?"Edit Blog Post":"Create New Blog Post"}),(0,n.jsxs)("form",{onSubmit:V,className:"space-y-4",children:[n.jsx(l.I,{value:p,maxLength:80,onChange:e=>g(e.target.value),placeholder:"Blog title"}),(0,n.jsxs)("p",{className:"text-xs text-muted-foreground text-right",children:[p.length,"/",80]}),n.jsx(d.g,{value:h,maxLength:160,onChange:e=>x(e.target.value),rows:3,placeholder:"Short summary shown on the blog list"}),(0,n.jsxs)("p",{className:"text-xs text-muted-foreground text-right",children:[h.length,"/",160]}),n.jsx(d.g,{value:b,onChange:e=>v(e.target.value),rows:8,placeholder:"Write the full blog content here..."}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(l.I,{value:y,onChange:e=>j(e.target.value),placeholder:"Author name"}),n.jsx(l.I,{value:N,onChange:e=>w(e.target.value),placeholder:"Read time (e.g. 3 min read)"})]}),(0,n.jsxs)(c.Ph,{value:k,onValueChange:E,children:[n.jsx(c.i4,{children:n.jsx(c.ki,{placeholder:"Select category"})}),(0,n.jsxs)(c.Bw,{children:[n.jsx(c.Ql,{value:"News",children:"News"}),n.jsx(c.Ql,{value:"Events",children:"Events"}),n.jsx(c.Ql,{value:"Updates",children:"Updates"}),n.jsx(c.Ql,{value:"Projects",children:"Projects"}),n.jsx(c.Ql,{value:"Team",children:"Team"}),n.jsx(c.Ql,{value:"Impact",children:"Impact"}),n.jsx(c.Ql,{value:"Stories",children:"Stories"})]})]}),(0,n.jsxs)("div",{children:[n.jsx("input",{type:"file",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];t&&(R(t),O(URL.createObjectURL(t)))}}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Upload a clear cover image for this blog"}),I&&n.jsx("img",{src:I,className:"mt-2 h-40 w-full object-cover rounded-xl"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[n.jsx(B,{checked:A,onCheckedChange:e=>C(!!e)}),n.jsx("span",{className:"text-sm",children:"Mark as featured post"})]}),(0,n.jsxs)("div",{children:[n.jsx("p",{className:"text-sm font-medium mb-2",children:"Tags"}),n.jsx("div",{className:"flex flex-wrap gap-3",children:W.map(e=>{let t=S.includes(e);return(0,n.jsxs)("button",{type:"button",onClick:()=>Q(e),className:`flex items-center gap-2 px-3 py-1.5 rounded-full border text-sm transition
                          ${t?"bg-primary text-primary-foreground border-primary":"bg-background hover:bg-muted"}
                        `,children:[n.jsx("span",{className:`w-4 h-4 rounded-full border flex items-center justify-center
                            ${t?"bg-primary border-primary":"border-muted-foreground"}
                          `,children:t&&n.jsx(M.Z,{size:10})}),e]},e)})})]}),n.jsx(o.z,{type:"submit",disabled:D,className:"w-full",children:D?"Saving...":r?"Update Blog":"Publish Blog"})]})]})})})}},76050:(e,t,r)=>{r.d(t,{Z:()=>f});var n=r(10326),a=r(75991),i=r(84386),s=r(91664),o=r(94019),l=r(17577),d=r(85999),c=r(35047),u=r(9543),m=r(34491);function f({isOpen:e,onClose:t,blogId:r}){let[f,p]=(0,l.useState)(!1),g=(0,c.useRouter)(),h=(0,u.v9)(e=>e.token.token),x=(0,u.I0)(),b=async()=>{if(r){console.log("bbbb",r),p(!0);try{if(!h){t(),d.A.error("Login expired, redirecting..."),g.push("/admin/auth/login");return}let e=await fetch(`/api/v1/admin/blog/delete/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${h}`}});if(401===e.status){t(),d.A.error("Session expired, redirecting..."),g.push("/admin/auth/login");return}let n=await e.json();if(!n.success)throw Error(n.message);n.success&&(d.A.success("blog deleted successfully"),x((0,m.X4)(r)),t()),t()}catch(e){console.error("Delete failed:",e),d.A.error(e.message||"Failed to delete blog")}finally{p(!1)}}};return n.jsx(a.AnimatePresence,{children:e&&n.jsx(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 px-4",children:(0,n.jsxs)(i.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.3},className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6 sm:p-8 relative overflow-y-auto",children:[n.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700 transition-colors",children:n.jsx(o.Z,{size:24})}),n.jsx("h2",{className:"text-2xl font-bold text-foreground mb-4",children:"Delete blog"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Are you sure you want to delete this blog? This action cannot be undone."}),(0,n.jsxs)("div",{className:"flex justify-end gap-4",children:[n.jsx(s.z,{variant:"outline",onClick:t,children:"Cancel"}),n.jsx(s.z,{variant:"destructive",onClick:b,disabled:f,children:f?"Deleting...":"Delete"})]})]})})})}},41190:(e,t,r)=>{r.d(t,{I:()=>s});var n=r(10326),a=r(17577),i=r(51223);let s=a.forwardRef(({className:e,type:t,...r},a)=>n.jsx("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...r}));s.displayName="Input"},82015:(e,t,r)=>{r.d(t,{g:()=>s});var n=r(10326),a=r(17577),i=r(51223);let s=a.forwardRef(({className:e,...t},r)=>n.jsx("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));s.displayName="Textarea"}};