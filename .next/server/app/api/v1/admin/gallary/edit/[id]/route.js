"use strict";(()=>{var e={};e.id=9478,e.ids=[9478],e.modules={38013:e=>{e.exports=require("mongodb")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},55315:e=>{e.exports=require("path")},86624:e=>{e.exports=require("querystring")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},7775:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>O,patchFetch:()=>R,requestAsyncStorage:()=>f,routeModule:()=>x,serverHooks:()=>y,staticGenerationAsyncStorage:()=>h});var r={};s.r(r),s.d(r,{PUT:()=>v});var a=s(49303),i=s(88716),n=s(60670),o=s(87070),u=s(75748),l=s(5732),d=s(41482),c=s.n(d),p=s(38013);let m=["Outreach","Team","Community","Elderly","Empowerment","Children","Education","Healthcare","Infrastructure","Events","Others"],g=["http://localhost:3000","https://cohaaf2.vercel.app"];async function v(e,{params:t}){try{let s=e.headers.get("origin");if(s&&!g.includes(s))return o.NextResponse.json({success:!1,message:"CORS policy: Origin not allowed"},{status:403});let r=e.headers.get("authorization"),a=r?.split(" ")[1];if(!a)return o.NextResponse.json({success:!1,message:"Unauthorized"},{status:401});try{c().verify(a,process.env.JWT_SECRET)}catch{return o.NextResponse.json({success:!1,message:"Invalid or expired token"},{status:401})}let{id:i}=await t;if(!p.ObjectId.isValid(i))return o.NextResponse.json({success:!1,message:"Invalid media ID"},{status:400});let{title:n,category:d,type:v,imageBase64:x,videoUrl:f,thumbnailBase64:h}=await e.json();if(!n)return o.NextResponse.json({success:!1,message:"Title is required"},{status:400});if(!d||!m.includes(d))return o.NextResponse.json({success:!1,message:"Invalid category"},{status:400});if(!v||!["image","video"].includes(v))return o.NextResponse.json({success:!1,message:"Invalid media type"},{status:400});let y=(await u.Z).db("connect_africa").collection("gallery"),O=await y.findOne({_id:new p.ObjectId(i)});if(!O)return o.NextResponse.json({success:!1,message:"Media not found"},{status:404});let R=O.src,_=O.thumbnail||null;"image"===v&&x&&(R=(await l.Z.uploader.upload(x,{folder:"gallery/images",resource_type:"image"})).secure_url,_=null),"video"===v&&(f&&(R=f),h&&(_=(await l.Z.uploader.upload(h,{folder:"gallery/thumbnails",resource_type:"image"})).secure_url)),await y.updateOne({_id:new p.ObjectId(i)},{$set:{title:n,category:d,type:v,src:R,thumbnail:_,updatedAt:new Date}});let j=await y.findOne({_id:new p.ObjectId(i)});return o.NextResponse.json({success:!0,message:"Media updated successfully",media:j})}catch(e){return console.error("Gallery update error:",e),o.NextResponse.json({success:!1,message:e.message||"Internal Server Error"},{status:500})}}let x=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/v1/admin/gallary/edit/[id]/route",pathname:"/api/v1/admin/gallary/edit/[id]",filename:"route",bundlePath:"app/api/v1/admin/gallary/edit/[id]/route"},resolvedPagePath:"C:\\Users\\HP\\OneDrive\\Desktop\\project2\\connect africa\\src\\app\\api\\v1\\admin\\gallary\\edit\\[id]\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:y}=x,O="/api/v1/admin/gallary/edit/[id]/route";function R(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:h})}},5732:(e,t,s)=>{s.d(t,{Z:()=>a});var r=s(49788);r.v2.config({cloud_name:process.env.CLOUDINARY_CLOUD_NAME,api_key:process.env.CLOUDINARY_API_KEY,api_secret:process.env.CLOUDINARY_API_SECRET});let a=r.v2},75748:(e,t,s)=>{s.d(t,{Z:()=>i});var r=s(38013);let a=process.env.MONGODB_URI;if(!a)throw Error("Please define MONGODB_URI in .env");let i=new r.MongoClient(a).connect()}};var t=require("../../../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[9276,5972,1482,9788],()=>s(7775));module.exports=r})();