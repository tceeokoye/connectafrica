"use strict";(()=>{var e={};e.id=5053,e.ids=[5053],e.modules={38013:e=>{e.exports=require("mongodb")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},55315:e=>{e.exports=require("path")},86624:e=>{e.exports=require("querystring")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},98742:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>R,patchFetch:()=>y,requestAsyncStorage:()=>v,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>x});var r={};s.r(r),s.d(r,{PUT:()=>f});var a=s(49303),o=s(88716),n=s(60670),i=s(87070),u=s(75748),p=s(5732),c=s(38013),d=s(41482),l=s.n(d);let g=["http://localhost:3000","https://connectafrica-fawn.vercel.app"];async function f(e,{params:t}){try{let s=e.headers.get("origin");if(s&&!g.includes(s))return i.NextResponse.json({success:!1,message:"CORS policy: Origin not allowed"},{status:403});let{id:r}=await t,a=e.headers.get("authorization"),o=a?.split(" ")[1];if(!o)return i.NextResponse.json({success:!1,message:"Unauthorized"},{status:401});try{l().verify(o,process.env.JWT_SECRET)}catch{return i.NextResponse.json({success:!1,message:"Invalid or expired token"},{status:401})}let{title:n,excerpt:d,content:f,author:m,readTime:v,category:x,imageBase64:h,tags:R,featured:y}=await e.json();if(!n||!d||!f||!m||!v||!x)return i.NextResponse.json({success:!1,message:"Missing required fields"},{status:400});if(R&&(!Array.isArray(R)||!R.every(e=>"string"==typeof e)))return i.NextResponse.json({success:!1,message:"Tags must be an array of strings"},{status:400});let q=(await u.Z).db("connect_africa").collection("blogs"),_=h;h?.startsWith("data:")&&(_=(await p.Z.uploader.upload(h,{folder:"blogs",resource_type:"image"})).secure_url),y&&await q.updateMany({featured:!0},{$set:{featured:!1}});let b={title:n,excerpt:d,content:f,author:m,readTime:v,category:x,image:_,tags:R||[],featured:!!y,updatedAt:new Date},O=await q.updateOne({_id:new c.ObjectId(r)},{$set:b});if(0===O.matchedCount)return i.NextResponse.json({success:!1,message:"Blog not found"},{status:404});return i.NextResponse.json({success:!0,message:"Blog updated successfully",blog:b})}catch(e){return console.error("Blog update error:",e),i.NextResponse.json({success:!1,message:e.message||"Internal Server Error"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/v1/admin/blog/edit/[id]/route",pathname:"/api/v1/admin/blog/edit/[id]",filename:"route",bundlePath:"app/api/v1/admin/blog/edit/[id]/route"},resolvedPagePath:"C:\\Users\\HP\\OneDrive\\Desktop\\project2\\connect africa\\src\\app\\api\\v1\\admin\\blog\\edit\\[id]\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:v,staticGenerationAsyncStorage:x,serverHooks:h}=m,R="/api/v1/admin/blog/edit/[id]/route";function y(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:x})}},5732:(e,t,s)=>{s.d(t,{Z:()=>a});var r=s(49788);r.v2.config({cloud_name:process.env.CLOUDINARY_CLOUD_NAME,api_key:process.env.CLOUDINARY_API_KEY,api_secret:process.env.CLOUDINARY_API_SECRET});let a=r.v2},75748:(e,t,s)=>{s.d(t,{Z:()=>o});var r=s(38013);let a=process.env.MONGODB_URI;if(!a)throw Error("Please define MONGODB_URI in .env");let o=new r.MongoClient(a).connect()}};var t=require("../../../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[9276,5972,1482,9788],()=>s(98742));module.exports=r})();