"use strict";(()=>{var e={};e.id=7515,e.ids=[7515],e.modules={38013:e=>{e.exports=require("mongodb")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},55315:e=>{e.exports=require("path")},86624:e=>{e.exports=require("querystring")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},80823:(e,s,r)=>{r.r(s),r.d(s,{originalPathname:()=>h,patchFetch:()=>R,requestAsyncStorage:()=>f,routeModule:()=>g,serverHooks:()=>v,staticGenerationAsyncStorage:()=>x});var t={};r.r(t),r.d(t,{POST:()=>m});var a=r(49303),n=r(88716),i=r(60670),o=r(87070),u=r(75748),c=r(5732),p=r(41482),d=r.n(p);let l=["http://localhost:3000","https://cohaaf2.vercel.app"];async function m(e){try{let s=e.headers.get("origin");if(s&&!l.includes(s))return o.NextResponse.json({success:!1,message:"CORS policy: Origin not allowed"},{status:403});let r=e.headers.get("authorization"),t=r?.split(" ")[1];if(!t)return o.NextResponse.json({success:!1,message:"Unauthorized"},{status:401});try{d().verify(t,process.env.JWT_SECRET)}catch(e){return o.NextResponse.json({success:!1,message:"Invalid or expired token"},{status:401})}let{title:a,description:n,amount:i,startDate:p,endDate:m,imageBase64:g,category:f}=await e.json();if(!a)return o.NextResponse.json({success:!1,message:"All fields are required: title is missing"},{status:400});if(!n)return o.NextResponse.json({success:!1,message:"All fields are required: description is missing"},{status:400});if(!i)return o.NextResponse.json({success:!1,message:"All fields are required: amount is missing"},{status:400});if(!f||!["Education","Community","Elderly","Empowerment","Children","Healthcare","Infrastructure","Events","Others","Food"].includes(f.trim()))return o.NextResponse.json({success:!1,message:"Invalid category"},{status:400});if(!p)return o.NextResponse.json({success:!1,message:"All fields are required: startDate is missing"},{status:400});if(!m)return o.NextResponse.json({success:!1,message:"All fields are required: endDate is missing"},{status:400});if(!g)return o.NextResponse.json({success:!1,message:"All fields are required: imageBase64 is missing"},{status:400});let x=await c.Z.uploader.upload(g,{folder:"campaigns",resource_type:"image"}),v=(await u.Z).db("connect_africa").collection("campaigns"),h={title:a,description:n,category:f,status:"inprogress",amount:Number(i),donatedAmount:0,startDate:new Date(p),endDate:new Date(m),imageUrl:x.secure_url,volunteers:0,createdAt:new Date,updatedAt:new Date},R=await v.insertOne(h),q=await v.findOne({_id:R.insertedId});return o.NextResponse.json({success:!0,message:"Campaign created!",campaign:q})}catch(e){return console.error("Campaign creation error:",e),o.NextResponse.json({success:!1,message:e.message||"Internal Server Error"},{status:500})}}let g=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/v1/admin/campaign/create/route",pathname:"/api/v1/admin/campaign/create",filename:"route",bundlePath:"app/api/v1/admin/campaign/create/route"},resolvedPagePath:"C:\\Users\\HP\\OneDrive\\Desktop\\project2\\connect africa\\src\\app\\api\\v1\\admin\\campaign\\create\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:f,staticGenerationAsyncStorage:x,serverHooks:v}=g,h="/api/v1/admin/campaign/create/route";function R(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:x})}},5732:(e,s,r)=>{r.d(s,{Z:()=>a});var t=r(49788);t.v2.config({cloud_name:process.env.CLOUDINARY_CLOUD_NAME,api_key:process.env.CLOUDINARY_API_KEY,api_secret:process.env.CLOUDINARY_API_SECRET});let a=t.v2},75748:(e,s,r)=>{r.d(s,{Z:()=>n});var t=r(38013);let a=process.env.MONGODB_URI;if(!a)throw Error("Please define MONGODB_URI in .env");let n=new t.MongoClient(a).connect()}};var s=require("../../../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[9276,5972,1482,9788],()=>r(80823));module.exports=t})();