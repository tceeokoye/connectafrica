(()=>{var e={};e.id=56,e.ids=[56],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8201:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),a(25648),a(49203),a(12523);var i=a(23191),r=a(88716),s=a(37922),l=a.n(s),n=a(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let c=["",{children:["admin",{children:["gallery",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,25648)),"C:\\Users\\HP\\OneDrive\\Desktop\\project2\\connect africa\\src\\app\\admin\\gallery\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,49203)),"C:\\Users\\HP\\OneDrive\\Desktop\\project2\\connect africa\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,12523)),"C:\\Users\\HP\\OneDrive\\Desktop\\project2\\connect africa\\src\\app\\not-found.tsx"]}],d=["C:\\Users\\HP\\OneDrive\\Desktop\\project2\\connect africa\\src\\app\\admin\\gallery\\page.tsx"],u="/admin/gallery/page",p={require:a,loadChunk:()=>Promise.resolve()},m=new i.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/gallery/page",pathname:"/admin/gallery",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6348:(e,t,a)=>{Promise.resolve().then(a.bind(a,98358))},94893:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});let i=(0,a(62881).Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},98358:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>k});var i=a(10326),r=a(17577),s=a(42106),l=a(9086),n=a(91664),o=a(83855),c=a(94893),d=a(69508),u=a(98091),p=a(41190),m=a(29280),x=a(94019),h=a(85999);class g extends Error{}g.prototype.name="InvalidTokenError";var f=a(9543);let y=["Outreach","Team","Community","Elderly","Empowerment","Children","Education","Healthcare","Infrastructure","Events","Others"];function v({isOpen:e,onClose:t,media:a,onSave:o}){let c=(0,f.v9)(e=>e.token.token),[d,u]=(0,r.useState)("image"),[v,j]=(0,r.useState)(""),[b,w]=(0,r.useState)(""),[N,k]=(0,r.useState)(null),[C,P]=(0,r.useState)(""),[E,S]=(0,r.useState)(null),[z,A]=(0,r.useState)(!1),_=e=>{let t=e.target.files?.[0];t&&(k(t),S(URL.createObjectURL(t)))},D=async e=>{e.preventDefault(),A(!0);try{if(!c)throw Error("Session expired");let e=function(e,t){let a;if("string"!=typeof e)throw new g("Invalid token specified: must be a string");t||(t={});let i=!0===t.header?0:1,r=e.split(".")[i];if("string"!=typeof r)throw new g(`Invalid token specified: missing part #${i+1}`);try{a=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var a;return a=t,decodeURIComponent(atob(a).replace(/(.)/g,(e,t)=>{let a=t.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a}))}catch(e){return atob(t)}}(r)}catch(e){throw new g(`Invalid token specified: invalid base64 for part #${i+1} (${e.message})`)}try{return JSON.parse(a)}catch(e){throw new g(`Invalid token specified: invalid json for part #${i+1} (${e.message})`)}}(c);if(1e3*e.exp<Date.now())throw Error("Session expired")}catch{h.A.error("Session expired. Please login again"),A(!1);return}if(!v||!b||"image"===d&&!N&&!a||"video"===d&&!C){h.A.error("Please fill all required fields"),A(!1);return}try{let e=E;N&&(e=await new Promise((e,t)=>{let a=new FileReader;a.readAsDataURL(N),a.onload=()=>e(a.result),a.onerror=t}));let i=a?`/api/v1/admin/gallary/edit/${a._id}`:"/api/v1/admin/gallary/create",r=await fetch(i,{method:a?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({type:d,title:v,category:b,imageBase64:"image"===d?e:void 0,videoUrl:"video"===d?C:void 0,thumbnailBase64:"video"===d?e:void 0})}),s=await r.json();if(!s.success)throw Error(s.message);h.A.success(a?"Media updated successfully":"Media uploaded successfully"),o&&await o(),t()}catch(e){h.A.error(e.message||"Failed to save media")}finally{A(!1)}};return i.jsx(l.M,{children:e&&i.jsx(s.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 px-4",children:(0,i.jsxs)(s.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-card rounded-2xl shadow-xl w-full max-w-lg p-6 relative max-h-[90vh] overflow-y-auto",children:[i.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-muted-foreground",children:i.jsx(x.Z,{size:20})}),i.jsx("h2",{className:"text-2xl font-bold mb-4",children:a?"Edit Media":"Upload Media"}),(0,i.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[i.jsx(p.I,{placeholder:"Media title",value:v,onChange:e=>j(e.target.value)}),(0,i.jsxs)(m.Ph,{value:b,onValueChange:w,children:[i.jsx(m.i4,{children:i.jsx(m.ki,{placeholder:"Select category"})}),i.jsx(m.Bw,{position:"popper",className:"max-h-60 overflow-y-auto",children:y.map(e=>i.jsx(m.Ql,{value:e,children:e},e))})]}),(0,i.jsxs)(m.Ph,{value:d,onValueChange:e=>u(e),children:[i.jsx(m.i4,{children:i.jsx(m.ki,{placeholder:"Select media type"})}),(0,i.jsxs)(m.Bw,{children:[i.jsx(m.Ql,{value:"image",children:"Image"}),i.jsx(m.Ql,{value:"video",children:"Video"})]})]}),"image"===d?i.jsx("input",{type:"file",accept:"image/*",onChange:_}):(0,i.jsxs)(i.Fragment,{children:[i.jsx(p.I,{placeholder:"YouTube / Video embed URL",value:C,onChange:e=>P(e.target.value)}),i.jsx("input",{type:"file",accept:"image/*",onChange:_})]}),E&&i.jsx("img",{src:E,className:"w-full h-40 object-cover rounded-xl"}),i.jsx(n.z,{type:"submit",disabled:z,className:"w-full",children:z?"Saving...":a?"Update Media":"Upload Media"})]})]})})})}var j=a(35047);function b({isOpen:e,onClose:t,mediaId:a,setMediaItems:o}){let[c,d]=(0,r.useState)(!1),u=(0,j.useRouter)(),p=(0,f.v9)(e=>e.token.token),m=(0,f.v9)(e=>e.gallery.gallery).find(e=>e._id===a),g=async()=>{if(a&&o){d(!0);try{if(!p){t(),h.A.error("Login expired, redirecting..."),u.push("/admin/login");return}let e=await fetch(`/api/v1/admin/gallary/delete/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${p}`}});if(401===e.status){t(),h.A.error("Session expired, redirecting..."),u.push("/admin/login");return}let i=await e.json();if(!i.success)throw Error(i.message);o(e=>e.filter(e=>e._id!==a)),h.A.success("Media deleted successfully"),t()}catch(e){console.error("Delete failed:",e),h.A.error(e.message||"Failed to delete campaign")}finally{d(!1)}}};return i.jsx(l.M,{children:e&&i.jsx(s.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 px-4",children:(0,i.jsxs)(s.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.3},className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6 sm:p-8 relative overflow-y-auto",children:[i.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700 transition-colors",children:i.jsx(x.Z,{size:24})}),(0,i.jsxs)("h2",{className:"text-2xl font-bold text-foreground mb-4",children:["Delete ",m?.type==="image"?"Image":"Video"]}),(0,i.jsxs)("p",{className:"text-sm text-muted-foreground mb-6",children:["Are you sure you want to delete this"," ",m?.type==="image"?"Image":"Video"," ? This action cannot be undone."]}),(0,i.jsxs)("div",{className:"flex justify-end gap-4",children:[i.jsx(n.z,{variant:"outline",onClick:t,children:"Cancel"}),i.jsx(n.z,{variant:"destructive",onClick:g,disabled:c,children:c?"Deleting...":"Delete"})]})]})})})}var w=a(80464);let N=["All","Outreach","Team","Community","Elderly","Empowerment","Children","Education","Healthcare","Infrastructure","Events","Videos"];function k(){var e;let t;let[a,p]=(0,r.useState)(!1),[m,x]=(0,r.useState)(),[g,f]=(0,r.useState)("All"),[y,j]=(0,r.useState)([]),[k,C]=(0,r.useState)(null),[P,E]=(0,r.useState)(!1),[S,z]=(0,r.useState)(!1),A=async()=>{z(!0);try{let e=await fetch("/api/v1/admin/gallary/get"),t=await e.json();if(t.success)j(t.media),z(!1);else throw Error(t.message)}catch(e){h.A.error(e.message||"Failed to fetch gallery"),z(!1)}finally{z(!1)}},_="All"===g?y:"Videos"===g?y.filter(e=>"video"===e.type):y.filter(e=>e.category===g);return i.jsx(i.Fragment,{children:i.jsx(w.Z,{children:(0,i.jsxs)("div",{className:"space-y-6 w-full ",children:[(0,i.jsxs)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-col md:flex-row gap-4 md:items-center md:justify-between",children:[(0,i.jsxs)("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Gallery"}),i.jsx("p",{className:"text-muted-foreground",children:"Manage gallery images and videos"})]}),(0,i.jsxs)(n.z,{onClick:()=>{x(void 0),p(!0)},children:[i.jsx(o.Z,{size:18})," Upload Media"]})]}),S?i.jsx("p",{className:" h-full flex items-center justify-center w-full py-20 text-center text-muted-foreground",children:"Loading gallery..."}):(0,i.jsxs)(i.Fragment,{children:[i.jsx("div",{className:" overflow-hidden sticky -top-[24.28px]  z-40 bg-background/95 px-6 -mx-6  border-b border-border ",children:i.jsx("section",{className:" border-b w-full overflow-x-auto border-border ",children:i.jsx("div",{className:"flex py-6 items-center gap-2 overflow-x-auto",children:N.map(e=>i.jsx("button",{onClick:()=>f(e),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${g===e?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:e},e))})})}),0===_.length?i.jsx("div",{className:"py-20 text-center text-muted-foreground",children:"No media found in this category."}):i.jsx("section",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 ",children:i.jsx(l.M,{mode:"popLayout",children:_.map(e=>(0,i.jsxs)(s.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.4},className:"relative bg-card rounded-xl overflow-hidden shadow-sm flex flex-col",children:[i.jsx("img",{src:"video"===e.type?e.thumbnail:e.src,alt:e.title,className:"w-full h-48 object-cover"}),"video"===e.type&&i.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center pointer-events-none",children:i.jsx(c.Z,{size:48,className:"text-white"})}),(0,i.jsxs)("div",{className:"p-3 flex-1 flex flex-col justify-between relative z-10",children:[(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"text-sm font-semibold",children:e.title}),i.jsx("p",{className:"text-xs text-muted-foreground",children:e.category})]}),(0,i.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,i.jsxs)(n.z,{size:"sm",variant:"outline",onClick:t=>{t.stopPropagation(),x(e),p(!0)},children:[i.jsx(d.Z,{size:16})," Edit"]}),(0,i.jsxs)(n.z,{size:"sm",variant:"destructive",onClick:t=>{t.stopPropagation(),x(e),E(!0)},children:[i.jsx(u.Z,{size:16})," Delete"]})]})]}),"video"===e.type&&i.jsx("div",{className:"absolute inset-0 cursor-pointer z-0",onClick:()=>C(e)})]},e._id))})})]}),i.jsx(l.M,{children:k&&i.jsx(s.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",onClick:()=>C(null),children:(0,i.jsxs)("div",{className:"relative max-w-3xl w-full",onClick:e=>e.stopPropagation(),children:["video"===k.type?k.src.includes("youtube.com")||k.src.includes("youtu.be")?i.jsx("iframe",{src:(e=k.src,t="",e.includes("youtu.be")?t=e.split("youtu.be/")[1].split("?")[0]:e.includes("youtube.com/watch")&&(t=new URLSearchParams(e.split("?")[1]).get("v")||""),`https://www.youtube.com/embed/${t}?autoplay=1`),title:k.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-96 rounded-lg"}):i.jsx("video",{src:k.src,controls:!0,autoPlay:!0,className:"w-full rounded-lg"}):i.jsx("img",{src:k.src,alt:k.title,className:"w-full rounded-lg"}),i.jsx("button",{onClick:()=>C(null),className:"absolute top-2 right-2 text-white text-2xl font-bold",children:"âœ•"})]})})}),i.jsx(b,{isOpen:P,onClose:()=>E(!1),mediaId:m?._id,setMediaItems:j}),i.jsx(v,{isOpen:a,onClose:()=>p(!1),media:m,onSave:A})]})})})}},41190:(e,t,a)=>{"use strict";a.d(t,{I:()=>l});var i=a(10326),r=a(17577),s=a(51223);let l=r.forwardRef(({className:e,type:t,...a},r)=>i.jsx("input",{type:t,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...a}));l.displayName="Input"},25648:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});let i=(0,a(68570).createProxy)(String.raw`C:\Users\HP\OneDrive\Desktop\project2\connect africa\src\app\admin\gallery\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),i=t.X(0,[9276,839,6262,257,1478,958],()=>a(8201));module.exports=i})();