"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9676],{7025:function(e,t,r){r.d(t,{Z:function(){return y}});var a=r(7437),s=r(2265),n=r(7586),i=r(8239),o=r(2381),l=r(279),d=r(3675),c=r(5291),u=r(7844),f=r(401),m=r(3448);let g=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(u.fC,{ref:t,className:(0,m.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...s,children:(0,a.jsx)(u.z$,{className:(0,m.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(f.Z,{className:"h-4 w-4"})})})});g.displayName=u.fC.displayName;var p=r(2489),x=r(4438),h=r(9376),b=r(2603);let v=["Food","Community","Outreach","Health","Education","Donation","Volunteers","Events","Impact"];function y(e){let{isOpen:t,onClose:r,blog:u,onSave:m}=e,y=(0,h.useRouter)(),j=(0,b.v9)(e=>e.token.token),[w,N]=(0,s.useState)(""),[k,C]=(0,s.useState)(""),[S,A]=(0,s.useState)(""),[z,R]=(0,s.useState)("Admin"),[_,B]=(0,s.useState)(""),[E,P]=(0,s.useState)("News"),[Z,T]=(0,s.useState)(!1),[D,I]=(0,s.useState)([]),[U,L]=(0,s.useState)(null),[Q,F]=(0,s.useState)(null),[O,V]=(0,s.useState)(!1);(0,s.useEffect)(()=>{u?(N(u.title),C(u.excerpt),A(u.content),R(u.author),B(u.readTime),P(u.category),T(!!u.featured),I(u.tags||[]),F(u.image||null)):M()},[u]);let M=()=>{N(""),C(""),A(""),R("Admin"),B(""),P("News"),T(!1),I([]),L(null),F(null)},Y=e=>{I(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},$=async e=>{if(e.preventDefault(),console.log("blog token",j),V(!0),!j){x.A.error("Your session expired. Please login again."),y.push("/admin/login"),V(!1);return}try{if(!j){V(!1),r(),x.A.error("Login expired, redirecting..."),y.push("/admin/login");return}}catch(e){x.A.error("Authentication failed. Please login again."),y.push("/admin/login"),V(!1);return}if(!w||!k||!S||!E){x.A.error("Please complete all required fields."),V(!1);return}if(!u&&!U){x.A.error("Please upload a blog image."),V(!1);return}try{let e=Q;if(U&&(e=await new Promise((e,t)=>{let r=new FileReader;r.readAsDataURL(U),r.onload=()=>e(r.result),r.onerror=t})),Z){let e=await fetch("/api/v1/admin/blog/unset-featured",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(j)}});if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.message||"Failed to unset existing featured blog (".concat(e.status,")"))}}let t=u?"/api/v1/admin/blog/edit/".concat(u._id):"/api/v1/admin/blog/create",a=await fetch(t,{method:u?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(j)},body:JSON.stringify({title:w,excerpt:k,content:S,author:z,readTime:_,category:E,featured:Z,tags:D,imageBase64:e})});if(401===a.status){x.A.error("Session expired. Please login again."),y.push("/admin/login"),V(!1);return}let s=await a.json();if(!a.ok)throw Error((null==s?void 0:s.message)||"Request failed (".concat(a.status,")"));x.A.success(u?"Blog updated âœ¨":"Blog published \uD83C\uDF89"),m&&await m(),r(),M()}catch(e){x.A.error(e.message||"Something went wrong.")}finally{V(!1)}};return(0,a.jsx)(n.M,{children:t&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 px-4",children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-card rounded-2xl shadow-xl w-full max-w-2xl p-6 relative overflow-y-auto max-h-[90vh]",children:[(0,a.jsx)("button",{onClick:r,className:"absolute top-4 right-4 text-muted-foreground hover:text-foreground",children:(0,a.jsx)(p.Z,{size:20})}),(0,a.jsx)("h2",{className:"text-2xl font-bold mb-5",children:u?"Edit Blog Post":"Create New Blog Post"}),(0,a.jsxs)("form",{onSubmit:$,className:"space-y-4",children:[(0,a.jsx)(l.I,{value:w,maxLength:80,onChange:e=>N(e.target.value),placeholder:"Blog title"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground text-right",children:[w.length,"/",80]}),(0,a.jsx)(d.g,{value:k,maxLength:160,onChange:e=>C(e.target.value),rows:3,placeholder:"Short summary shown on the blog list"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground text-right",children:[k.length,"/",160]}),(0,a.jsx)(d.g,{value:S,onChange:e=>A(e.target.value),rows:8,placeholder:"Write the full blog content here..."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(l.I,{value:z,onChange:e=>R(e.target.value),placeholder:"Author name"}),(0,a.jsx)(l.I,{value:_,onChange:e=>B(e.target.value),placeholder:"Read time (e.g. 3 min read)"})]}),(0,a.jsxs)(c.Ph,{value:E,onValueChange:P,children:[(0,a.jsx)(c.i4,{children:(0,a.jsx)(c.ki,{placeholder:"Select category"})}),(0,a.jsxs)(c.Bw,{children:[(0,a.jsx)(c.Ql,{value:"News",children:"News"}),(0,a.jsx)(c.Ql,{value:"Events",children:"Events"}),(0,a.jsx)(c.Ql,{value:"Updates",children:"Updates"}),(0,a.jsx)(c.Ql,{value:"Projects",children:"Projects"}),(0,a.jsx)(c.Ql,{value:"Team",children:"Team"}),(0,a.jsx)(c.Ql,{value:"Impact",children:"Impact"}),(0,a.jsx)(c.Ql,{value:"Stories",children:"Stories"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&(L(r),F(URL.createObjectURL(r)))}}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Upload a clear cover image for this blog"}),Q&&(0,a.jsx)("img",{src:Q,className:"mt-2 h-40 w-full object-cover rounded-xl"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g,{checked:Z,onCheckedChange:e=>T(!!e)}),(0,a.jsx)("span",{className:"text-sm",children:"Mark as featured post"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-2",children:"Tags"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-3",children:v.map(e=>{let t=D.includes(e);return(0,a.jsxs)("button",{type:"button",onClick:()=>Y(e),className:"flex items-center gap-2 px-3 py-1.5 rounded-full border text-sm transition\n                          ".concat(t?"bg-primary text-primary-foreground border-primary":"bg-background hover:bg-muted","\n                        "),children:[(0,a.jsx)("span",{className:"w-4 h-4 rounded-full border flex items-center justify-center\n                            ".concat(t?"bg-primary border-primary":"border-muted-foreground","\n                          "),children:t&&(0,a.jsx)(f.Z,{size:10})}),e]},e)})})]}),(0,a.jsx)(o.z,{type:"submit",disabled:O,className:"w-full",children:O?"Saving...":u?"Update Blog":"Publish Blog"})]})]})})})}},5426:function(e,t,r){r.d(t,{Z:function(){return m}});var a=r(7437),s=r(7586),n=r(8239),i=r(2381),o=r(2489),l=r(2265),d=r(4438),c=r(9376),u=r(2603),f=r(5699);function m(e){let{isOpen:t,onClose:r,blogId:m}=e,[g,p]=(0,l.useState)(!1),x=(0,c.useRouter)(),h=(0,u.v9)(e=>e.token.token),b=(0,u.I0)(),v=async()=>{if(m){console.log("bbbb",m),p(!0);try{if(!h){r(),d.A.error("Login expired, redirecting..."),x.push("/admin/login");return}let e=await fetch("/api/v1/admin/blog/delete/".concat(m),{method:"DELETE",headers:{Authorization:"Bearer ".concat(h)}});if(401===e.status){r(),d.A.error("Session expired, redirecting..."),x.push("/admin/login");return}let t=await e.json();if(!t.success)throw Error(t.message);t.success&&(d.A.success("blog deleted successfully"),b((0,f.X4)(m)),r()),r()}catch(e){console.error("Delete failed:",e),d.A.error(e.message||"Failed to delete blog")}finally{p(!1)}}};return(0,a.jsx)(s.M,{children:t&&(0,a.jsx)(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 px-4",children:(0,a.jsxs)(n.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.3},className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6 sm:p-8 relative overflow-y-auto",children:[(0,a.jsx)("button",{onClick:r,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700 transition-colors",children:(0,a.jsx)(o.Z,{size:24})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-4",children:"Delete blog"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-6",children:"Are you sure you want to delete this blog? This action cannot be undone."}),(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsx)(i.z,{variant:"outline",onClick:r,children:"Cancel"}),(0,a.jsx)(i.z,{variant:"destructive",onClick:v,disabled:g,children:g?"Deleting...":"Delete"})]})]})})})}},2381:function(e,t,r){r.d(t,{z:function(){return d}});var a=r(7437),s=r(2265),n=r(7495),i=r(535),o=r(3448);let l=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,a.jsx)(u,{className:(0,o.cn)(l({variant:s,size:i,className:r})),ref:t,...c})});d.displayName="Button"},279:function(e,t,r){r.d(t,{I:function(){return i}});var a=r(7437),s=r(2265),n=r(3448);let i=s.forwardRef((e,t)=>{let{className:r,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},5291:function(e,t,r){r.d(t,{Bw:function(){return p},Ph:function(){return c},Ql:function(){return x},i4:function(){return f},ki:function(){return u}});var a=r(7437),s=r(2265),n=r(3837),i=r(875),o=r(2135),l=r(401),d=r(3448);let c=n.fC;n.ZA;let u=n.B4,f=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsxs)(n.xz,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...o,children:[s,(0,a.jsx)(n.JO,{asChild:!0,children:(0,a.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});f.displayName=n.xz.displayName;let m=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.u_,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})});m.displayName=n.u_.displayName;let g=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.$G,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});g.displayName=n.$G.displayName;let p=s.forwardRef((e,t)=>{let{className:r,children:s,position:i="popper",...o}=e;return(0,a.jsx)(n.h_,{children:(0,a.jsxs)(n.VY,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:i,...o,children:[(0,a.jsx)(m,{}),(0,a.jsx)(n.l_,{className:(0,d.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,a.jsx)(g,{})]})})});p.displayName=n.VY.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.__,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...s})}).displayName=n.__.displayName;let x=s.forwardRef((e,t)=>{let{className:r,children:s,...i}=e;return(0,a.jsxs)(n.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",r),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(n.eT,{children:s})]})});x.displayName=n.ck.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=n.Z0.displayName},3675:function(e,t,r){r.d(t,{g:function(){return i}});var a=r(7437),s=r(2265),n=r(3448);let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...s})});i.displayName="Textarea"},3448:function(e,t,r){r.d(t,{cn:function(){return n}});var a=r(1994),s=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}},5699:function(e,t,r){r.d(t,{X4:function(){return o},dr:function(){return s}});let a=(0,r(7281).oM)({name:"blogs",initialState:{blogs:[]},reducers:{setBlogs(e,t){e.blogs=t.payload},addBlog(e,t){e.blogs.unshift(t.payload)},updateBlog(e,t){let r=e.blogs.findIndex(e=>e._id===t.payload._id);-1!==r&&(e.blogs[r]=t.payload)},deleteBlog(e,t){e.blogs=e.blogs.filter(e=>e._id!==t.payload)}}}),{setBlogs:s,addBlog:n,updateBlog:i,deleteBlog:o}=a.actions;t.ZP=a.reducer}}]);